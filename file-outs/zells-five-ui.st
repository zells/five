Morph subclass: #Z5ClockScopeMorph	instanceVariableNames: 'zell text'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 12:01'!acceptDroppingMorph: aMorph event: evt	zell addSignal: aMorph zell.! !!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:04'!drawOn: canvas	| points |	super drawOn: canvas.	canvas frameOval: (self center - (7@7) extent: 14@14) color: (Color gray).		points := ({-3@ -3. 0@0. -3@3} collect: [:p|p+self center+(2@ -7)]).	canvas line: (points at: 1) to: (points at: 2) color: (Color gray).	canvas line: (points at: 2) to: (points at: 3) color: (Color gray).! !!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 12:03'!forZell: aZell	zell := aZell.	zell onChanged: [:z|self refresh].	self refresh.! !!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:37'!initialize	super initialize.	self color: Color black.	self extent: 300@100.	self layoutPolicy: TableLayout new.! !!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 11:59'!refresh	self removeAllMorphs.	zell signals do: [:s | self addMorph: (Z5StemZellMorph for: s)]! !!Z5ClockScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 11:52'!wantsDroppedMorph: aMorph event: anEvent 	^ aMorph isKindOf: Z5StemZellMorph! !Morph subclass: #Z5DishMorph	instanceVariableNames: 'dish zellMorphs transmissionSpeed'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 20:04'!addMorph: morph	super addMorph: morph.	(morph isKindOf: Z5ZellMorph) ifTrue: [ self addZellMorph: morph ]! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/29/2017 11:56'!addZellMorph: morph	self calculateDelaysFrom: morph.	morph zell onEmit: [:signal | self showTransmission: morph].		(zellMorphs includes: morph) ifFalse: [		zellMorphs add: morph.		dish add: morph zell. ].	morph onDeleted: [ :m | 		dish remove: m zell.		zellMorphs remove: m ifAbsent: []].! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 18:11'!calculateDelaysFrom: zellMorph	zellMorphs do: [ :m |.		dish delayBetween: (m zell) and: (zellMorph zell) is: (m center dist: zellMorph center) / transmissionSpeed ]! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 19:13'!dish: aDish	dish := aDish.	dish onZellAdded: [ :z | 		| zellMorph  |		zellMorph := Z5ButtonZellMorph for: z.		((zellMorphs collect: [ :m | m zell ]) includes: z) 			ifFalse: [				zellMorphs add: zellMorph.				self addMorph: (zellMorph					position: self center;					yourself) ] ]! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/14/2017 16:37'!handlesMouseDown: event	^ true! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:27'!initialize	super initialize.		zellMorphs := Set new.	transmissionSpeed := 400.		self color: Color black.	self extent: 300@350.! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/14/2017 16:38'!mouseDown: event	self submorphs do: [ :m |		(m bounds containsPoint: event cursorPoint) ifTrue: [			m mouseDown: event ]]! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:46'!recalculateDelays	zellMorphs do: [:morph | self calculateDelaysFrom: morph]! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:42'!showTransmission: morph	self addMorph: ((Z5SignalAnimationMorph for: morph) speed: transmissionSpeed)! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:47'!transmissionSpeed: speed	transmissionSpeed := speed.	self recalculateDelays.! !!Z5DishMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/16/2017 10:34'!wantsDroppedMorph: aMorph event: anEvent 	^ aMorph isKindOf: Z5ZellMorph! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Z5DishMorph class	instanceVariableNames: ''!!Z5DishMorph class methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 15:11'!for: dish	^ Z5DishMorph new dish: dish! !Morph subclass: #Z5EmitterScopeMorph	instanceVariableNames: 'zell'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5EmitterScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 10:14'!acceptDroppingMorph: aMorph event: evt	zell emit: aMorph zell.! !!Z5EmitterScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:04'!drawOn: canvas	| points |	super drawOn: canvas.	canvas fillOval: (self center + (-6@ -1) extent: 2@2) color: (Color gray).		points := ({-8@ -5. -3@0. -8@5} collect: [:p|p+self center+(10@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (Color gray).	canvas line: (points at: 2) to: (points at: 3) color: (Color gray).		points := ({-11@ -3. -8@0. -11@3} collect: [:p|p+self center+(10@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (Color gray).	canvas line: (points at: 2) to: (points at: 3) color: (Color gray).! !!Z5EmitterScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 10:09'!forZell: aZell	zell := aZell.	"self addMorph: (Z5EmitterInputMorph new 		forZell: aZell; 		yourself)."! !!Z5EmitterScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/15/2017 15:58'!initialize	super initialize.	self color: Color black.	self extent: 200@100.! !!Z5EmitterScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 10:10'!wantsDroppedMorph: aMorph event: anEvent 	^ aMorph isKindOf: Z5StemZellMorph! !Morph subclass: #Z5ListenerScopeMorph	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ListenerScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 18:11'!add: aStemZell	self addMorph: (Z5StemZellMorph for: aStemZell).! !!Z5ListenerScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/25/2017 14:05'!handlesMouseDown: event	^ true! !!Z5ListenerScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:31'!initialize	super initialize.	self color: Color black.	self extent: 400@350.	self layoutPolicy: TableLayout new.! !!Z5ListenerScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/25/2017 14:07'!mouseDown: event	self submorphs do: [ :m |		(m bounds containsPoint: event cursorPoint) ifTrue: [			m copy openInHand ]]! !Morph subclass: #Z5SignalAnimationMorph	instanceVariableNames: 'radius zellMorph speed start'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/21/2017 11:44'!drawOn: canvas	| clipped |	clipped := canvas copyClipRect: self bounds.	clipped frameOval: (self ovalRect) color: (self color mixed: 0.5 with: Color black).! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 18:06'!initialize	super initialize.	radius := 0.	start := Time millisecondClockValue.! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/13/2017 13:51'!ovalRect	^ (zellMorph center - radius) extent: (radius*2)@(radius*2).! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 17:26'!speed: theSpeed	speed := theSpeed.! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 18:24'!step	| inside |	inside := zellMorph owner bounds.	radius := (Time millisecondClockValue - start) / 1000 * speed.	self changed.		((radius/1.4 > (inside width)) and: (radius/1.4 > (inside height))) ifTrue: [ 			self delete. 		radius := 0 	].	self changed.! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/27/2017 11:59'!stepTime	 ^ 40.! !!Z5SignalAnimationMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:43'!zellMorph: aZellMorph	zellMorph := aZellMorph.	self color: aZellMorph color.	self bounds: aZellMorph owner bounds.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Z5SignalAnimationMorph class	instanceVariableNames: ''!!Z5SignalAnimationMorph class methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 17:25'!for: zellMorph	^ self new		zellMorph: zellMorph;		yourself! !Morph subclass: #Z5TurtleScopeMorph	instanceVariableNames: 'turtle'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5TurtleScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 21:14'!drawOn: canvas	| p1 clipped |	clipped := canvas copyClipRect: self bounds..			super drawOn: canvas.	p1 := turtle path first.	turtle path do: [ :p | 		clipped line: (self position + p1) to: (self position + p) color: Color white.		p1 := p ].	clipped drawPolygon: self triangle		color: (Color green mixed: 0.5 with: Color white)		borderWidth: 0		borderColor: nil.! !!Z5TurtleScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/15/2017 22:58'!forZell: aZell	turtle := aZell.	turtle observedBy: self.! !!Z5TurtleScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/15/2017 22:53'!initialize	super initialize.	self color: Color black.	self extent: 200@200.! !!Z5TurtleScopeMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/22/2017 10:13'!triangle	^ { 9 @ 0.	-5 @ 5. -5 @ -5 } collect: [ :x | 			self position + turtle position 			+ (x rotateBy: turtle heading degreesToRadians about: 0@0) ]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Z5TurtleScopeMorph class	instanceVariableNames: ''!!Z5TurtleScopeMorph class methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 20:44'!for: zell	^ (self new)		forZell: zell;		yourself.! !Morph subclass: #Z5ZellMorph	instanceVariableNames: 'zell receiving transmitting events'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:56'!acceptDroppingMorph: aMorph event: evt	(aMorph isKindOf: Z5StemZellMorph) ifTrue: [self zell receive: aMorph zell]! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:49'!accepted: signal	[ 		receiving := true.		self changed.		(Delay forMilliseconds: 100) wait. 		receiving := false. 		self changed. 	] fork.! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 19:51'!delete	events trigger: #deleted with: self.	super delete.! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:26'!drawOn: canvas	canvas 		frameOval: (self bounds)		color: (transmitting ifTrue: [Color white] ifFalse: [self color]).			receiving ifTrue: [ 		canvas 			fillOval: (self bounds) 			color: (self color mixed: 0.3 with: Color black) ].! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:49'!initialize	super initialize.	receiving := false.	transmitting := false.	events := Z5EventHandler new.	self color: (((Color wheel: 8) atRandom) mixed: 0.5 with: (Color white)).	self extent: 30@30.! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 16:07'!onDeleted: block	events on: #deleted do: block.! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:38'!transmit: signal	[		transmitting := true.		self changed.		(Delay forMilliseconds: 100) wait. 		transmitting := false.		self changed.	] fork.	! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:54'!wantsDroppedMorph: aMorph event: anEvent 	^ aMorph isKindOf: Z5ZellMorph! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 15:42'!zell	^ zell.! !!Z5ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 21:50'!zell: aZell	zell := aZell		onEmit: [ :s | self transmit: s ];		onAccept: [ :s | self accepted: s ];		yourself! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Z5ZellMorph class	instanceVariableNames: ''!!Z5ZellMorph class methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 19:21'!for: zell	^ self new zell: zell; yourself.! !Z5ZellMorph subclass: #Z5ButtonZellMorph	instanceVariableNames: 'text string signal'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ButtonZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/19/2017 08:44'!changed	super changed.	string ifNotNil: [:s| s position: self center - (string extent / 2)].! !!Z5ButtonZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 17:14'!initialize	super initialize.	self color: (Color red mixed: 0.5 with: Color white).		self zell: (Z5DynamicZell doing: [ :s :z |		self signal: s]).		string := StringMorph new		color: self color;		contents: '!!';		yourself.	self addMorph: string.! !!Z5ButtonZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 17:10'!mouseDown: event	zell receive: #touch.! !!Z5ButtonZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 17:19'!signal: s	s = #touch 		ifTrue: [signal ifNotNil: [self zell emit: signal]]		ifFalse: [signal ifNil: [signal := s. string contents: s name. self changed.]]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Z5ButtonZellMorph class	instanceVariableNames: ''!!Z5ButtonZellMorph class methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 19:55'!emitting: signal	^ self new 		signal: signal;		yourself.! !Z5ZellMorph subclass: #Z5ClockZellMorph	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ClockZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 19:58'!drawOn: canvas	| points |	super drawOn: canvas.	canvas frameOval: (self center - (7@7) extent: 14@14) color: (self color).		points := ({-3@ -3. 0@0. -3@3} collect: [:p|p+self center+(2@ -7)]).	canvas line: (points at: 1) to: (points at: 2) color: (self color).	canvas line: (points at: 2) to: (points at: 3) color: (self color).! !!Z5ClockZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/18/2017 20:26'!initialize	super initialize.	self zell: (Z5ClockZell new).! !!Z5ClockZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:36'!mouseDown: event	| scope |	scope := (Z5ClockScopeMorph new forZell: zell) openInWindow.	scope position: (self owner owner bounds bottomLeft + (0@20)).! !Z5ZellMorph subclass: #Z5EmitterZellMorph	instanceVariableNames: 'isOpen'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5EmitterZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 19:52'!drawOn: canvas	| points |	super drawOn: canvas.	canvas fillOval: (self center + (-6@ -1) extent: 2@2) color: (self color).		points := ({-8@ -5. -3@0. -8@5} collect: [:p|p+self center+(10@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (self color).	canvas line: (points at: 2) to: (points at: 3) color: (self color).		points := ({-11@ -3. -8@0. -11@3} collect: [:p|p+self center+(10@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (self color).	canvas line: (points at: 2) to: (points at: 3) color: (self color).! !!Z5EmitterZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/25/2017 13:19'!initialize	super initialize.	self zell: Z5Zell new.! !!Z5EmitterZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 20:32'!mouseDown: event	(Z5EmitterScopeMorph new		forZell: zell; 		yourself) 			openInWindow 			position: (self owner owner bounds topRight + (20@0))! !Z5ZellMorph subclass: #Z5ListenerZellMorph	instanceVariableNames: 'scope'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5ListenerZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/26/2017 19:50'!drawOn: canvas	| points |	super drawOn: canvas.	canvas fillOval: (self center + (4@ -1) extent: 2@2) color: (self color).		points := ({-8@ -5. -3@0. -8@5} collect: [:p|p+self center+(3@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (self color).	canvas line: (points at: 2) to: (points at: 3) color: (self color).		points := ({-11@ -3. -8@0. -11@3} collect: [:p|p+self center+(3@0)]).	canvas line: (points at: 1) to: (points at: 2) color: (self color).	canvas line: (points at: 2) to: (points at: 3) color: (self color).! !!Z5ListenerZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:45'!handlesMouseDown: event	 ^ true! !!Z5ListenerZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 09:47'!initialize	super initialize.	self color: (Color blue mixed: 0.5 with: Color white).	self zell: (Z5DynamicZell doing: [:s :z | 		z accept: s. 		self receive: s])! !!Z5ListenerZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:49'!mouseDown: event	scope := Z5ListenerScopeMorph new.		scope openInWindow		position: (self owner owner 			ifNotNil: [self owner owner bounds topLeft - (scope width + 30 @0) ]			ifNil: [self position - ((scope width / 2) @ scope height + 50)])! !!Z5ListenerZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 12:52'!receive: signal	scope ifNotNil: [scope add: signal]! !Z5ZellMorph subclass: #Z5StemZellMorph	instanceVariableNames: 'name isA hasAs'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5StemZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/23/2017 22:49'!drawOn: canvas	| leftClipped rightClipped half full |	full := self height.	half := full / 2.		leftClipped := canvas copyClipRect: (self position extent: half @ self height).	leftClipped frameOval: (self position extent: full @ self height) color: self color.	rightClipped := canvas copyClipRect: ((self topRight - (half@0)) extent: half @ self height).	rightClipped frameOval: ((self topRight - (full@0)) extent: full @ self height) color: self color.		canvas line: (self position + (half@0)) to: (self topRight - (half@0)) color: self color.	canvas line: (self bottomLeft + (half@ -1)) to: (self bottomRight - (half@ 1)) color: self color.! !!Z5StemZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/23/2017 22:52'!initialize	super initialize.	self extent: 40@40.! !!Z5StemZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/24/2017 12:29'!zell: aStemZell	| lastHasAPosition |	super zell: aStemZell.		name := StringMorph new		color: self color;		contents: (aStemZell name ifNil: ['']);		yourself.	self addMorph: name.		isA := StringMorph new		color: self color;		contents: (aStemZell isA ifNil: ['']);		yourself.	self addMorph: isA.	self zell onBeingA: [:a|isA contents: a].		self width: (name width max: (isA width)) + (self height - 16).		name position: (self position + ((self width /2)@(self height - name height - 2))  - ((name width / 2) @0)).	isA position: (self position + ((self width /2)@2)  - ((isA width / 2) @0)).		hasAs := aStemZell hasAs collect: [:a | Z5StemZellMorph for: a].	self addAllMorphs: hasAs.		lastHasAPosition := self topRight + (0@5).	hasAs do: [:a|		self width: (self width + a width + 5).		self height: (self height max: (a height + 10)).		a position: lastHasAPosition.		lastHasAPosition := lastHasAPosition + (a width@0) + (5@0)].! !Z5ZellMorph subclass: #Z5TurtleZellMorph	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'zells-five-ui'!!Z5TurtleZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:52'!drawOn: canvas	super drawOn: canvas.	canvas drawPolygon: ({0@ -7. 5@7. -5@7} collect: [:x|self center + x])		color: (self color)		borderWidth: 0		borderColor: nil.! !!Z5TurtleZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:49'!handlesMouseDown: event	 ^ true! !!Z5TurtleZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 5/25/2017 23:51'!initialize	super initialize.	self zell: Z5TurtleZell new.	self color: (Color green mixed: 0.5 with: Color white).! !!Z5TurtleZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 7/13/2017 16:49'!mouseDown: event	| scope |	scope := (Z5TurtleScopeMorph new forZell: zell) openInWindow.	scope position: (self owner owner 			ifNotNil: [self owner owner bounds bottomRight - (-20@ scope height)]			ifNil: [self position - ((scope width / 2) @ scope height + 50)])! !